#!/usr/bin/env ruby

require 'camtool.rb'
require 'rgl/dot'
require 'rgl/topsort'
require 'rgl/transitivity'

instruction = ARGV[0]
target = ARGV[1]
puts target

if instruction == '--info'
  print CamTool::ProvJSONtoRGL.new.read_log_file(target).information
  CamTool::EdgeCounter.new.read_log_file(target).show
  CamTool::VertexCounter.new.read_log_file(target).show
elsif instruction == '--publish'
  CamTool::MQTTBreaker.new.break_log_file target
elsif instruction == '--break'
  CamTool::LogBreaker.new.break_log_file target
elsif instruction == '--validate'
  CamTool::ProvJSONtoRGL.new.read_log_file(target).validate
  puts 'Graph structure verified...'
  CamTool::EdgeValidator.new.read_log_file(target)
  puts 'Relations verified...'
elsif instruction == '--packet'
  CamTool::CheckPacket.new.read_log_file(target)
elsif instruction == '--png'
  print CamTool::ProvJSONtoRGL.new.read_log_file(target).png
elsif instruction == '--list'
  CamTool::ProvJSONtoRGL.new.read_log_file(target).list
elsif instruction == '--tree'
  CamTool::ProvJSONtoRGL.new.read_log_file(target).tree(ARGV[2])
elsif instruction == '--neighbour'
  puts CamTool::ProvJSONtoRGL.new.read_log_file(target).neighbour(ARGV[2])
elsif instruction == '--sentences'
  CamTool::ProvJSONtoRGL.new.read_log_file(target).sentences
else
  puts '--info <path to log file>'
  puts '--publish <path to log file>'
  puts '--break <path to log file>'
  puts '--png <path to log file>'
  puts '--packet <path to log file>'
  puts '--validate <path to log file>'
  puts '--list <path to log file>'
  puts '--tree <path to log file> <id>'
  puts '--neighbour <path to log file> <id>'
end
